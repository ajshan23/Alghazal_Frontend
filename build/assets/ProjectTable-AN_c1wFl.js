import{a0 as L,$ as A,ac as T,a1 as E,a as F,j as e,r as u,v as b}from"./index-CZ-QxqVN.js";import{D as I}from"./DataTable-C-dnd2Pg.js";import{W as O,$ as R,N as $,V as K}from"./index-kD3pbGz6.js";import{F as q}from"./index-yKKiR9wp.js";import{t as z,N as B}from"./toast-CoCmtbLn.js";import{C as H}from"./ConfirmDialog-m53FmWqq.js";import{b as V,a as M}from"./SalesService-tE_Bnw6z.js";import{u as _}from"./useQuery-Dc0MXxK0.js";import{d as U}from"./debounce-CZ8YaKg6.js";import{I as G}from"./Input-C15wo5ys.js";import{b as Q}from"./api-ayPWnM6X.js";import"./Alert-vZZK0s39.js";import"./index-DdzAiQaI.js";import"./Badge-M_R8BM5O.js";import{B as g}from"./Button-wTWRjSOp.js";import"./index-WCrMc_mB.js";import"./Card-DYSpZm-g.js";import"./index-Dhhfgcmn.js";import"./Dialog-5Q7WvFhs.js";import"./Drawer-Cgxg1eSD.js";import"./index-BRrKuFuY.js";import"./FormItem-BFRIpM45.js";import"./useUniqueId-BHonA5r7.js";import"./Upload-CNTsixo0.js";import"./index-Cee-dHef.js";import"./index-CUYy2E4V.js";import"./ScrollBar-CX8t2iP4.js";import"./Select-ukccBfLg.js";import"./Tag-gTkDLVan.js";import"./StatusIcon-D9-As4b9.js";import"./CloseButton-DDicOJ3W.js";import"./chainedFunction-BxZSneMW.js";import"./proxy-D7sJR9rS.js";import"./Views-BmihdypO.js";import"./toString-DttkkGgf.js";import"./context-B6r7oiwN.js";import"./floating-ui.react-B1qnMOd0.js";import"./floating-ui.dom-B_iSk-nO.js";import"./index-cPHdE-6C.js";import"./_getPrototype-lWKxFJo-.js";import"./index-DzN3DWMt.js";import"./index-CFpcu7wG.js";import"./index-D2JWHt9J.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-C_KtrfhP.js";const v="salesProductList",h=A(v+"/getProducts",async t=>(await M(t)).data),W=async t=>(await V(t)).data,J={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},X={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:J,filterData:{name:"",category:["bags","cloths","devices","shoes","watches"],status:[0,1,2],productStatus:0}},N=L({name:`${v}/state`,initialState:X,reducers:{updateProductList:(t,a)=>{t.productList=a.payload},setTableData:(t,a)=>{t.tableData=a.payload},setFilterData:(t,a)=>{t.filterData=a.payload},toggleDeleteConfirmation:(t,a)=>{t.deleteConfirmation=a.payload},setSelectedProduct:(t,a)=>{t.selectedProduct=a.payload}},extraReducers:t=>{t.addCase(h.fulfilled,(a,c)=>{a.productList=c.payload.data,a.tableData.total=c.payload.total,a.loading=!1}).addCase(h.pending,a=>{a.loading=!0})}}),{updateProductList:We,setTableData:Je,setFilterData:Xe,toggleDeleteConfirmation:y,setSelectedProduct:Ye}=N.actions,Y=N.reducer;E({data:Y});const x=T,Z=()=>{const t=F(),a=x(s=>{var n,i;return(i=(n=s.salesProductList)==null?void 0:n.data)==null?void 0:i.deleteConfirmation}),c=x(s=>{var n,i;return(i=(n=s.salesProductList)==null?void 0:n.data)==null?void 0:i.selectedProduct}),d=x(s=>{var n,i;return(i=(n=s.salesProductList)==null?void 0:n.data)==null?void 0:i.tableData}),l=()=>{t(y(!1))},m=async()=>{t(y(!1)),await W({id:c})&&(t(h(d)),z.push(e.jsx(B,{title:"Successfuly Deleted",type:"success",duration:2500,children:"Product successfuly deleted"}),{placement:"top-center"}))};return e.jsx(H,{isOpen:a,type:"danger",title:"Delete product",confirmButtonColor:"red-600",onClose:l,onRequestClose:l,onCancel:l,onConfirm:m,children:e.jsx("p",{children:"Are you sure you want to delete this product? All record related to this product will be deleted as well. This action cannot be undone."})})},ee=({row:t})=>{const a=b(),c=()=>{a(`/app/project-edit/${t._id}`)},d=()=>{a(`/app/project-view/${t==null?void 0:t._id}`)};return e.jsxs("div",{className:"flex justify-start gap-2",children:[e.jsx(g,{size:"sm",variant:"plain",icon:e.jsx($,{}),onClick:d,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",tooltip:"View Project"}),e.jsx(g,{size:"sm",variant:"plain",icon:e.jsx(K,{}),onClick:c,className:"text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",tooltip:"Edit Project"})]})},te=({progress:t})=>{const a=parseInt(t)||0;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${a}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 min-w-[40px]",children:[a,"%"]})]})},ae=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Ze=()=>{var f,j;const t=u.useRef(null),a=b(),[c,d]=u.useState(""),[l,m]=u.useState({page:1,limit:10}),{data:s,isLoading:n,error:i,refetch:P}=_({queryKey:["projects",l.page,l.limit,c],queryFn:()=>Q({page:l.page,limit:l.limit,search:c}),keepPreviousData:!0}),w=u.useMemo(()=>U(r=>{d(r),m(o=>({...o,page:1}))},500),[]),D=r=>{w(r.target.value)},C=u.useMemo(()=>[{header:"Project Name",accessorKey:"projectName",cell:r=>{var o,p;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-lg mr-3",children:e.jsx(q,{className:"text-white text-lg"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800 dark:text-white",children:(o=r.row.original)==null?void 0:o.projectName}),((p=r.row.original)==null?void 0:p.projectNumber)&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["#",r.row.original.projectNumber]})]})]})}},{header:"Client",accessorKey:"clientName",cell:r=>{var o,p;return e.jsx("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:(p=(o=r.row.original)==null?void 0:o.client)==null?void 0:p.clientName})}},{header:"Progress",accessorKey:"progress",cell:r=>{var o;return e.jsx(te,{progress:(o=r.row.original)==null?void 0:o.progress})}},{header:"Created Date",accessorKey:"createdAt",cell:r=>{var o;return e.jsx("div",{className:"text-gray-600 dark:text-gray-400 font-medium",children:ae((o=r.row.original)==null?void 0:o.createdAt)})}},{header:"Actions",id:"action",cell:r=>e.jsx(ee,{row:r.row.original}),enableSorting:!1}],[]),k=r=>{m(o=>({...o,page:r}))},S=r=>{m(o=>({page:1,limit:r}))};return i?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 text-center",children:[e.jsx("div",{className:"text-red-600 dark:text-red-400 font-medium mb-2",children:"Error loading projects"}),e.jsx("div",{className:"text-sm text-red-500 dark:text-red-300",children:i.message}),e.jsx(g,{className:"mt-4",onClick:()=>P(),variant:"solid",children:"Try Again"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Projects"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(G,{placeholder:"Search projects...",onChange:D,className:"max-w-md",prefix:e.jsx(O,{className:"text-lg text-gray-400"})}),e.jsx(g,{variant:"solid",icon:e.jsx(R,{}),className:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white",onClick:()=>a("/app/project-new"),children:"New Project"})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsx(I,{ref:t,columns:C,data:((f=s==null?void 0:s.data)==null?void 0:f.projects)||[],skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:n,pagingData:{total:((j=s==null?void 0:s.data)==null?void 0:j.total)||0,pageIndex:l.page,pageSize:l.limit},onPaginationChange:k,onSelectChange:S})}),e.jsx(Z,{})]})};export{Ze as default};
