import{r as i,j as e,v as N}from"./index-CZ-QxqVN.js";import{A as I}from"./AdaptableCard-Ce_KsDG0.js";import{D as $}from"./DataTable-C-dnd2Pg.js";import{W as B,$ as E,V as F,_ as H}from"./index-kD3pbGz6.js";import{b as K}from"./index-yKKiR9wp.js";import{u as R}from"./useQuery-Dc0MXxK0.js";import{d as q}from"./debounce-CZ8YaKg6.js";import{I as z}from"./Input-C15wo5ys.js";import{d as L,f as _}from"./api-C7B1VRuz.js";import{C as M}from"./ConfirmDialog-m53FmWqq.js";import{t as C,N as v}from"./toast-CoCmtbLn.js";import"./Alert-vZZK0s39.js";import"./index-DdzAiQaI.js";import"./Badge-M_R8BM5O.js";import{B as g}from"./Button-wTWRjSOp.js";import"./index-WCrMc_mB.js";import"./Card-DYSpZm-g.js";import"./index-Dhhfgcmn.js";import"./Dialog-5Q7WvFhs.js";import"./Drawer-Cgxg1eSD.js";import"./index-BRrKuFuY.js";import"./FormItem-BFRIpM45.js";import"./useUniqueId-BHonA5r7.js";import"./Upload-CNTsixo0.js";import"./index-Cee-dHef.js";import"./index-CUYy2E4V.js";import"./ScrollBar-CX8t2iP4.js";import"./Select-ukccBfLg.js";import"./Tag-gTkDLVan.js";import"./Views-BmihdypO.js";import"./toString-DttkkGgf.js";import"./context-B6r7oiwN.js";import"./StatusIcon-D9-As4b9.js";import"./CloseButton-DDicOJ3W.js";import"./chainedFunction-BxZSneMW.js";import"./proxy-D7sJR9rS.js";import"./floating-ui.react-B1qnMOd0.js";import"./floating-ui.dom-B_iSk-nO.js";import"./index-cPHdE-6C.js";import"./_getPrototype-lWKxFJo-.js";import"./index-DzN3DWMt.js";import"./index-CFpcu7wG.js";import"./index-D2JWHt9J.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-C_KtrfhP.js";const Q=({isOpen:r,onClose:s,category:a,refetch:x})=>{const[n,l]=i.useState(!1);if(!r||!a)return null;const u=async()=>{var c,m;l(!0);try{await L(a._id),x(),C.push(e.jsx(v,{title:`Category "${a.name}" deleted`,type:"success",duration:2500,children:"The category has been successfully deleted."}),{placement:"top-center"}),s()}catch(o){console.error("Delete failed:",o),C.push(e.jsx(v,{title:`Failed to delete category "${a.name}"`,type:"danger",duration:2500,children:((m=(c=o==null?void 0:o.response)==null?void 0:c.data)==null?void 0:m.message)||o.message||"Something went wrong"}),{placement:"top-center"})}finally{l(!1)}};return e.jsxs(M,{isOpen:r,type:"danger",title:`Delete Category "${a.name}"`,confirmButtonColor:"red-600",onClose:s,onRequestClose:s,onCancel:s,onConfirm:u,confirmButtonDisabled:n,children:[e.jsxs("p",{children:['Are you sure you want to delete the category "',a.name,'"? This action cannot be undone.']}),n&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("div",{className:"w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})})]})},V=({row:r,onDeleteClick:s})=>{const a=N();return e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(g,{size:"sm",variant:"plain",icon:e.jsx(F,{}),onClick:()=>a(`/app/new-cat/${r._id}`),className:"text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",tooltip:"Edit Category"}),e.jsx(g,{size:"sm",variant:"plain",icon:e.jsx(H,{}),onClick:()=>s(r),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors",tooltip:"Delete Category"})]})},W=({row:r})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg mr-3",children:e.jsx(K,{className:"text-white text-lg"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800 dark:text-white",children:r.name}),r.description&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-1 max-w-xs",children:r.description})]})]}),G=({description:r})=>e.jsx("div",{className:"max-w-xs",children:e.jsx("span",{className:"text-gray-700 dark:text-gray-300 line-clamp-2",children:r||"No description"})}),J=({date:r})=>e.jsx("span",{className:"text-gray-600 dark:text-gray-400 text-sm font-medium",children:new Date(r).toLocaleDateString()}),U=()=>{var j,b;const r=i.useRef(null),s=N(),[a,x]=i.useState(""),[n,l]=i.useState({page:1,limit:10}),[u,c]=i.useState(null),[m,o]=i.useState(!1),{data:d,isLoading:w,error:f,refetch:y}=R({queryKey:["categories",n.page,n.limit,a],queryFn:()=>_({page:n.page,limit:n.limit,search:a})}),k=((j=d==null?void 0:d.data)==null?void 0:j.categories)||[],h=((b=d==null?void 0:d.data)==null?void 0:b.pagination)||{total:0,page:1,limit:10},D=i.useMemo(()=>q(t=>{x(t),l(p=>({...p,page:1}))},500),[]),S=t=>{D(t.target.value)},A=t=>{c(t),o(!0)},T=i.useMemo(()=>[{header:"Category",accessorKey:"name",cell:t=>e.jsx(W,{row:t.row.original})},{header:"Description",accessorKey:"description",cell:t=>e.jsx(G,{description:t.row.original.description})},{header:"Created Date",accessorKey:"createdAt",cell:t=>e.jsx(J,{date:t.row.original.createdAt})},{header:"Actions",id:"action",cell:t=>e.jsx(V,{row:t.row.original,onDeleteClick:A}),enableSorting:!1}],[]),O=t=>{l(p=>({...p,page:t}))},P=t=>{l(p=>({page:1,limit:t}))};return f?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 text-center",children:[e.jsx("div",{className:"text-red-600 dark:text-red-400 font-medium mb-2",children:"Error loading categories"}),e.jsx("div",{className:"text-sm text-red-500 dark:text-red-300",children:f.message}),e.jsx(g,{className:"mt-4",onClick:()=>y(),variant:"solid",children:"Try Again"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Categories"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(z,{placeholder:"Search categories...",onChange:S,className:"max-w-md",prefix:e.jsx(B,{className:"text-lg text-gray-400"})}),e.jsx(g,{variant:"solid",icon:e.jsx(E,{}),className:"bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white",onClick:()=>s("/app/new-cat"),children:"Add Category"})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsx($,{ref:r,columns:T,data:k,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:w,pagingData:{total:h.total,pageIndex:h.page,pageSize:h.limit},onPaginationChange:O,onSelectChange:P})}),e.jsx(Q,{isOpen:m,onClose:()=>o(!1),category:u,refetch:y})]})},_e=()=>e.jsxs(I,{className:"h-full",bodyClass:"h-full",children:[e.jsx("div",{className:"lg:flex items-center justify-between mb-4"}),e.jsx(U,{})]});export{_e as default};
