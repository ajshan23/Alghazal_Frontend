import{j as e,c as Fe,ad as pe,$ as he,a0 as qe,a1 as ze,r as l,m as Ue,ab as I,T as Be,a8 as fe,v as be,u as Ve,aa as We,b as Ge,a2 as Ye}from"./index-BqYC2zCO.js";import"./Alert-Praf8Fi9.js";import{A as z}from"./index-BhxlP8yV.js";import{B as P}from"./Badge-CrbEpOhk.js";import{B as j}from"./Button-BZH25-Aw.js";import"./index-Bm5J6gtn.js";import{C as E}from"./Card-DiA6JKLe.js";import"./index-o6PoulbO.js";import{D as ye}from"./Dialog-C85wTnEL.js";import{D as Qe}from"./Drawer-3BaRt1RV.js";import"./index-BNWCw_o_.js";import"./FormItem-FeS_vrRF.js";import"./useUniqueId-BmsTzdR7.js";import{I as Xe}from"./Input-CF7OdvAt.js";import"./Upload-B1V-WMlx.js";import"./index-fwAOcRNC.js";import{t as S,N as A}from"./toast-BNCR3rph.js";import"./index-BkSrbwb3.js";import"./ScrollBar-bvGQZvnP.js";import"./Select-3fyDv9Rf.js";import{T as Je}from"./Tag-DOC98LxQ.js";import{au as Ke,af as Ze,ag as er,av as rr,a4 as sr,aw as de,ax as tr,ay as ar,N as je,H as or,az as nr,n as U,aA as me,x as H,ar as L,aB as ve,aC as Ne,$ as ir,U as lr,aD as cr,S as dr,j as mr,aE as xr}from"./index-CErL3g3x.js";import{N as gr}from"./react-number-format.es-BGUL9v2_.js";import{u as ur}from"./useThemeClass-CB8d6Ww5.js";import{e as pr}from"./index-Z1Egzvm9.js";import{A as hr}from"./AdaptableCard-DChiyDM1.js";import{C as fr}from"./Views-B3egHxO-.js";import"./StatusIcon-CrxJz663.js";import"./CloseButton-L6WjsDsk.js";import"./proxy-DBs-aCG0.js";import"./floating-ui.react-DBGHfBho.js";import"./floating-ui.dom-B_iSk-nO.js";import"./index-BLbmKy6n.js";import"./context-CKHslMnf.js";import"./_getPrototype-_N1fRqzo.js";import"./index-DtRKDKi1.js";import"./toString-sucKyfO-.js";import"./chainedFunction-BxZSneMW.js";import"./index-BnTamqJo.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-7CwaeXnJ.js";const T=({className:r,asElement:s="span",icon:n,children:o})=>e.jsxs(s,{className:Fe("flex items-center gap-2",r),children:[n,o]});async function br(){return pe.fetchData({url:"/crypto/wallets",method:"get"})}async function yr(r){return pe.fetchData({url:"/crypto/wallets/history",method:"post",data:r})}const B="cryptoWallets",xe=he(B+"/getWalletData",async()=>(await br()).data),ge=he(B+"/getTransctionHistoryData",async r=>(await yr(r)).data),jr={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},vr={loading:!0,walletsData:[],transactionHistoryLoading:!0,transactionHistoryData:[],tableData:jr,selectedTab:"trade"},we=qe({name:`${B}/state`,initialState:vr,reducers:{setSelectedTab:(r,s)=>{r.selectedTab=s.payload},setTableData:(r,s)=>{r.tableData=s.payload},setTransactionHistoryData:(r,s)=>{r.transactionHistoryData=s.payload}},extraReducers:r=>{r.addCase(xe.fulfilled,(s,n)=>{s.loading=!1,s.walletsData=n.payload}).addCase(xe.pending,s=>{s.loading=!0}).addCase(ge.fulfilled,(s,n)=>{s.transactionHistoryLoading=!1,s.tableData.total=n.payload.total,s.transactionHistoryData=n.payload.data}).addCase(ge.pending,s=>{s.transactionHistoryLoading=!0})}}),{setSelectedTab:Hs,setTableData:Rs,setTransactionHistoryData:Ls}=we.actions,Nr=we.reducer,wr=ze({data:Nr});var kr={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function Cr(r){if(typeof r=="number")return{value:r,unit:"px"};var s,n=(r.match(/^[0-9.]*/)||"").toString();n.includes(".")?s=parseFloat(n):s=parseInt(n,10);var o=(r.match(/[^0-9]*$/)||"").toString();return kr[o]?{value:s,unit:o}:(console.warn("React Spinners: ".concat(r," is not a valid css value. Defaulting to ").concat(s,"px.")),{value:s,unit:"px"})}function ue(r){var s=Cr(r);return"".concat(s.value).concat(s.unit)}var Sr=function(r,s,n){var o="react-spinners-".concat(r,"-").concat(n);if(typeof window>"u"||!window.document)return o;var i=document.createElement("style");document.head.appendChild(i);var d=i.sheet,t=`
    @keyframes `.concat(o,` {
      `).concat(s,`
    }
  `);return d&&d.insertRule(t,0),o},M=function(){return M=Object.assign||function(r){for(var s,n=1,o=arguments.length;n<o;n++){s=arguments[n];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])}return r},M.apply(this,arguments)},Ar=function(r,s){var n={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&s.indexOf(o)<0&&(n[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(r);i<o.length;i++)s.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(r,o[i])&&(n[o[i]]=r[o[i]]);return n},Ir=Sr("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");function q(r){var s=r.loading,n=s===void 0?!0:s,o=r.color,i=o===void 0?"#000000":o,d=r.speedMultiplier,t=d===void 0?1:d,x=r.cssOverride,p=x===void 0?{}:x,u=r.size,h=u===void 0?35:u,g=Ar(r,["loading","color","speedMultiplier","cssOverride","size"]),v=M({background:"transparent !important",width:ue(h),height:ue(h),borderRadius:"100%",border:"2px solid",borderTopColor:i,borderBottomColor:"transparent",borderLeftColor:i,borderRightColor:i,display:"inline-block",animation:"".concat(Ir," ").concat(.75/t,"s 0s infinite linear"),animationFillMode:"both"},p);return n?l.createElement("span",M({style:v},g)):null}const Tr=({clientinformation:r})=>{var s,n,o,i,d;return e.jsxs(E,{children:[e.jsx("h5",{className:"mb-4",children:"Customer"}),e.jsxs(Ue,{className:"group flex items-center justify-between",to:"/app/crm/customer-details?id=11",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"ltr:ml-2 rtl:mr-2",children:e.jsxs("span",{children:["Name : ",(s=r==null?void 0:r.client)==null?void 0:s.clientName]})})}),e.jsx(Ke,{className:"text-xl hidden group-hover:block"})]}),e.jsx("hr",{className:"my-5"}),e.jsx(T,{className:"mb-4",icon:e.jsx(Ze,{className:"text-xl opacity-70"}),children:e.jsx("span",{className:"font-semibold",children:(n=r==null?void 0:r.client)==null?void 0:n.email})}),e.jsx(T,{icon:e.jsx(pr,{className:"text-xl opacity-70"}),children:e.jsx("span",{className:"font-semibold",children:(o=r==null?void 0:r.client)==null?void 0:o.mobileNumber})}),e.jsx("br",{}),e.jsx(T,{icon:e.jsx(er,{className:"text-xl opacity-70"}),children:e.jsx("span",{className:"font-semibold",children:(i=r==null?void 0:r.client)==null?void 0:i.telephoneNumber})}),e.jsx("hr",{className:"my-5"}),e.jsx("h6",{className:"mb-4",children:"Shipping Address"}),e.jsx("address",{className:"not-italic",children:e.jsx("div",{className:"mb-1",children:(d=r==null?void 0:r.client)==null?void 0:d.clientAddress})})]})},_r=({projectdetails:r})=>{var s,n,o;return e.jsxs(E,{children:[e.jsx("h5",{className:"mb-4",children:"Project Details"}),e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"ltr:ml-2 rtl:mr-2",children:[e.jsx("div",{className:"font-semibold text-lg",children:r==null?void 0:r.projectName}),e.jsx("div",{className:"font-semibold text-lg",children:r==null?void 0:r.projectNumber})]})}),e.jsx("hr",{className:"my-5"}),e.jsx("h6",{className:"mb-3",children:"Project Description"}),e.jsxs("div",{className:"flex items-start mb-5",children:[e.jsx(rr,{className:"text-xl opacity-70 mt-1 mr-2"}),e.jsx("p",{className:"text-gray-700",children:(r==null?void 0:r.projectDescription)||"No description provided"})]}),e.jsx("hr",{className:"my-5"}),e.jsx("h6",{className:"mb-3",children:"Site Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(T,{icon:e.jsx(sr,{className:"text-xl opacity-70"}),children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Site Location"}),e.jsx("div",{className:"text-gray-700",children:(r==null?void 0:r.location)||"Not specified"})]})}),e.jsx(T,{icon:e.jsx(de,{className:"text-xl opacity-70"}),children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Building"}),e.jsx("div",{className:"text-gray-700",children:(r==null?void 0:r.building)||"Not specified"})]})}),e.jsx(T,{icon:e.jsx(de,{className:"text-xl opacity-70"}),children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Apartment"}),e.jsx("div",{className:"text-gray-700",children:(r==null?void 0:r.apartmentNumber)||"Not specified"})]})})]}),(r==null?void 0:r.client)&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-5"}),e.jsx("h6",{className:"mb-3",children:"Client Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Name: "}),e.jsx("span",{children:(s=r==null?void 0:r.client)==null?void 0:s.clientName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Address: "}),e.jsx("span",{children:(n=r==null?void 0:r.client)==null?void 0:n.clientAddress})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Phone: "}),e.jsx("span",{children:(o=r==null?void 0:r.client)==null?void 0:o.mobileNumber})]})]})]})]})},R=async r=>{try{console.log("project data : ",r);const s=await I.get(`/project/${r}`);return console.log(s),s.data}catch(s){throw console.log(s),s}},Pr=async()=>{try{const r=await I.get("/user/engineers/");return console.log(r),r.data}catch(r){throw console.log(r),r}},Er=async({projectId:r,engineerId:s})=>{var n;try{return console.log(r,"project id"),console.log(s,"engineerId "),(await I.post(`/project/${r}/assign`,{assignedTo:s})).data}catch(o){throw console.error("Assignment error details:",{error:o,response:(n=o.response)==null?void 0:n.data}),o}},$r=async({estimationId:r,isChecked:s,comment:n})=>{var o;try{return(await I.patch(`/estimation/${r}/check`,{isChecked:s,comment:n})).data}catch(i){throw console.error("Error checking project:",{error:i,response:(o=i.response)==null?void 0:o.data}),i}},Or=async({estimationId:r,isApproved:s,comment:n})=>{var o;try{return(await I.patch(`/estimation/${r}/approve`,{isApproved:s,comment:n})).data}catch(i){throw console.error("Error checking project:",{error:i,response:(o=i.response)==null?void 0:o.data}),i}},Hr=async r=>{try{return await I.get(`/comment/${r}`)}catch(s){throw console.log(s),s}},Rr=async(r,s)=>{try{console.log("idddd",r);const n=await I.post(`/comment/${r}`,{content:s});return console.log(n),n.data}catch(n){throw console.log(n),n}},Lr=({children:r,...s})=>e.jsx(z,{...s,size:30,shape:"circle",children:r}),Mr=({status:r,time:s})=>{const o=(()=>{switch(r.toLowerCase()){case"approval":case"approved":return{bg:"bg-emerald-500",icon:e.jsx(or,{className:"text-white"}),text:"Approved"};case"check":case"checked":return{bg:"bg-yellow-500",icon:e.jsx(je,{className:"text-white"}),text:"Checked"};case"reject":case"rejected":return{bg:"bg-red-500",icon:e.jsx(ar,{className:"text-white"}),text:"Rejected"};default:return{bg:"bg-blue-500",icon:e.jsx(tr,{className:"text-white"}),text:"General"}}})();return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Je,{prefix:!0,className:`${o.bg} text-white mr-2 rtl:ml-2`,prefixClass:o.bg,children:e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"mr-1",children:o.icon}),o.text]})}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s})]})},Dr=({comment:r})=>e.jsxs("div",{className:"flex mb-4",children:[e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx(Lr,{src:r.img})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100 mr-2",children:r.name}),e.jsx(Mr,{status:r.actionType||"general",time:r.time})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-200 pl-1",children:r.comment})]})]}),Fr=({projectId:r,refresh:s=!1})=>{const[n,o]=l.useState(!0),[i,d]=l.useState([]),[t,x]=l.useState(!1),p=l.useRef(null),[u,h]=l.useState("");l.useEffect(()=>{r&&g()},[r,s]);const g=async()=>{o(!0);try{const k=((await Hr(r)).data.data||[]).map(f=>{const N=f.user||{},$=`${N.firstName||""} ${N.lastName||""}`.trim()||"Unknown User";return h(N.profileImage),{id:f._id,name:$,img:N.profileImage?N.profileImage:"/img/avatars/thumb-1.jpg",time:f.createdAt?new Date(f.createdAt).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0,day:"numeric",month:"short"}):"Just now",comment:f.content||"",actionType:f.actionType||"general"}});d(k)}catch(m){console.error("Failed to fetch comments:",m)}finally{o(!1)}},v=async()=>{var b;const m=(b=p.current)==null?void 0:b.value;if(!(!(m!=null&&m.trim())||!r))try{x(!0);const k={id:Date.now().toString(),name:"You",img:"/img/avatars/thumb-1.jpg",time:"just now",comment:m,actionType:"general"};d(f=>[k,...f]),p.current&&(p.current.value=""),await Rr(r,m),await g()}catch(k){console.error("Failed to post comment:",k),d(f=>f.filter(N=>N.id!==Date.now().toString()))}finally{x(!1)}};return e.jsx(fr,{className:"h-full",children:e.jsx(Be,{loading:n,children:e.jsxs(hr,{bodyClass:"p-5",children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Activity"}),e.jsx("div",{className:"mb-6",children:i.map(m=>e.jsx(Dr,{comment:m},m.id))}),e.jsx("div",{className:"mt-6 mb-3 flex flex-auto",children:e.jsx("div",{className:"ml-4 rtl:mr-4 w-full",children:e.jsx(Xe,{ref:p,textArea:!0,placeholder:"Leave a comment",disabled:t})})}),e.jsx("div",{className:"text-right",children:e.jsx(j,{variant:"solid",onClick:v,loading:t,disabled:t,children:"Comment"})})]})})})},qr=({data:r,onAddClick:s})=>{ur();const n=be(),{id:o}=fe(),i=()=>{switch(r.type){case"estimation":return e.jsx(U,{className:"text-3xl"});case"quotation":return e.jsx(xr,{className:"text-3xl"});case"lpo":return e.jsx(mr,{className:"text-3xl"});case"workProgress":return e.jsx(dr,{className:"text-3xl"});case"invoice":return e.jsx(cr,{className:"text-3xl"});case"expenseTracker":return e.jsx(lr,{className:"text-3xl"});default:return e.jsx(U,{className:"text-3xl"})}},d=()=>{r.exists?r.type==="quotation"?n(`/app/quotation-view/${o}`):r.type==="expenseTracker"?n(r.viewRoute||`/app/expense/${o}`):n(r.viewRoute||r.route,{state:{projectId:o}}):s(r.type)},t=()=>{switch(r.type){case"estimation":return"from-blue-400 via-blue-500 to-blue-600";case"quotation":return"from-purple-400 via-purple-500 to-purple-600";case"lpo":return"from-green-400 via-green-500 to-green-600";case"workProgress":return"from-orange-400 via-orange-500 to-orange-600";case"invoice":return"from-indigo-400 via-indigo-500 to-indigo-600";case"expenseTracker":return"from-red-400 via-red-500 to-red-600";default:return"from-gray-400 via-gray-500 to-gray-600"}},x=()=>{switch(r.type){case"estimation":return"border-blue-200 dark:border-blue-800";case"quotation":return"border-purple-200 dark:border-purple-800";case"lpo":return"border-green-200 dark:border-green-800";case"workProgress":return"border-orange-200 dark:border-orange-800";case"invoice":return"border-indigo-200 dark:border-indigo-800";case"expenseTracker":return"border-red-200 dark:border-red-800";default:return"border-gray-200 dark:border-gray-800"}};return e.jsx("div",{className:"group relative",children:r.exists?e.jsx(E,{className:`h-full transition-all duration-300 hover:shadow-2xl hover:-translate-y-1 bg-gradient-to-br from-white via-gray-50 to-white dark:from-gray-800 dark:via-gray-850 dark:to-gray-900 border-2 ${x()} hover:border-opacity-60`,children:e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("div",{className:`absolute top-0 left-0 w-full h-1 bg-gradient-to-r ${t()}`}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-r ${t()} text-white shadow-lg group-hover:shadow-xl transition-shadow duration-300`,children:i()}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-bold text-xl text-gray-800 dark:text-gray-100",children:r.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Document"})]})]}),r.status&&e.jsx(P,{content:r.status,className:"px-3 py-1 text-xs font-semibold",innerClass:`${r.status==="approved"?"bg-emerald-500":r.status==="pending"?"bg-amber-500":"bg-blue-500"} shadow-lg`})]}),e.jsxs("div",{className:"space-y-3",children:[r.amount&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Amount"}),e.jsx("h4",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.jsx(gr,{displayType:"text",value:r.amount,prefix:"$",thousandSeparator:!0,decimalScale:2})})]}),r.date&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(ve,{}),e.jsx("span",{children:Ge(r.date).format("MMM D, YYYY")})]})]}),e.jsx(j,{className:"w-full mt-4 font-semibold transition-all duration-200 hover:scale-105",size:"sm",variant:"solid",icon:e.jsx(je,{className:"text-lg"}),onClick:d,style:{background:`linear-gradient(135deg, ${r.type==="estimation"?"#3b82f6, #1d4ed8":r.type==="quotation"?"#8b5cf6, #7c3aed":r.type==="lpo"?"#10b981, #059669":r.type==="workProgress"?"#f59e0b, #d97706":r.type==="invoice"?"#6366f1, #4f46e5":"#ef4444, #dc2626"})`,border:"none",boxShadow:"0 4px 15px rgba(0,0,0,0.1)"},children:"View"})]})]})}):e.jsx(E,{clickable:!0,className:"group border-dashed border-3 hover:border-indigo-400 dark:hover:border-gray-300 bg-gradient-to-br from-gray-50 via-white to-gray-50 dark:from-gray-800 dark:via-gray-850 dark:to-gray-900 h-full flex items-center justify-center transition-all duration-300 hover:shadow-xl hover:-translate-y-1",onClick:d,children:e.jsxs("div",{className:"flex flex-col justify-center items-center py-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-4 rounded-full bg-gradient-to-r from-indigo-100 via-purple-100 to-pink-100 dark:from-indigo-900 dark:via-purple-900 dark:to-pink-900 transition-all duration-300 group-hover:scale-110",children:e.jsx(ir,{className:"text-3xl text-indigo-500 dark:text-indigo-400"})}),e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-gradient-to-r from-indigo-400 to-purple-500 rounded-full animate-pulse"})]}),e.jsxs("p",{className:"mt-4 font-bold text-lg text-gray-700 dark:text-gray-200 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors",children:["Add ",r.title]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Click to create new document"})]})})})},zr=({isOpen:r,onClose:s,estimationId:n,onSuccess:o})=>{const[i,d]=l.useState(""),[t,x]=l.useState(!1),[p,u]=l.useState(null),h=async g=>{var v,m;x(!0),u(null);try{await Or({estimationId:n,isApproved:g,comment:i||void 0}),S.push(e.jsx(A,{title:`Project ${g?"approved":"rejected"} successfully`,type:"success"}),{placement:"top-center"}),o(),s()}catch(b){console.error("Error updating project status:",b),u(((m=(v=b.response)==null?void 0:v.data)==null?void 0:m.message)||"Failed to update project status"),S.push(e.jsx(A,{title:"Failed to update project status",type:"danger"}),{placement:"top-center"})}finally{x(!1)}};return e.jsx(ye,{isOpen:r,onClose:s,width:500,className:"dark:bg-gray-800 rounded-xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg",children:e.jsx(L,{className:"text-2xl text-white"})}),e.jsx("h5",{className:"text-xl font-bold dark:text-white",children:"Update Project Status"})]}),p&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg dark:bg-red-900/30 dark:text-red-400 dark:border-red-800",children:p}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block mb-3 font-semibold text-gray-700 dark:text-gray-300",children:"Comments"}),e.jsx("textarea",{className:"w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all duration-200",rows:4,value:i,onChange:g=>d(g.target.value),placeholder:"Enter your comments here..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(j,{variant:"plain",onClick:()=>h(!1),disabled:t,className:"px-6 py-2 text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/30 font-semibold border-2 border-red-200 dark:border-red-800 rounded-lg transition-all duration-200",children:t?"Processing...":"Reject"}),e.jsx(j,{variant:"solid",onClick:()=>h(!0),disabled:t,className:"px-6 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200",children:t?"Processing...":"Approve"})]})]})})},Ur=We.memo(({isOpen:r,onClose:s,estimationId:n,onSuccess:o})=>{const[i,d]=l.useState(""),[t,x]=l.useState(!1),[p,u]=l.useState(null),h=async g=>{var v,m;x(!0),u(null);try{await $r({estimationId:n,isChecked:g,comment:i||void 0}),S.push(e.jsx(A,{title:`Project ${g?"checked":"rejected"} successfully`,type:"success"}),{placement:"top-center"}),o(),s(),d("")}catch(b){console.error("Error updating project status:",b),u(((m=(v=b.response)==null?void 0:v.data)==null?void 0:m.message)||"Failed to update project status"),S.push(e.jsx(A,{title:"Failed to update project status",type:"danger"}),{placement:"top-center"})}finally{x(!1)}};return l.useEffect(()=>{r||(d(""),u(null))},[r]),e.jsx(ye,{isOpen:r,onClose:s,width:500,className:"dark:bg-gray-800 rounded-xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-green-500 to-teal-600 rounded-lg",children:e.jsx(Ne,{className:"text-2xl text-white"})}),e.jsx("h5",{className:"text-xl font-bold dark:text-white",children:"Verify Project"})]}),p&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg dark:bg-red-900/30 dark:text-red-400 dark:border-red-800",children:p}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block mb-3 font-semibold text-gray-700 dark:text-gray-300",children:"Comments"}),e.jsx("textarea",{className:"w-full p-4 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring-2 focus:ring-green-200 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all duration-200",rows:4,value:i,onChange:g=>d(g.target.value),placeholder:"Enter your comments here..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(j,{variant:"plain",onClick:()=>h(!1),disabled:t,className:"px-6 py-2 text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/30 font-semibold border-2 border-red-200 dark:border-red-800 rounded-lg transition-all duration-200",children:t?"Processing...":"Reject"}),e.jsx(j,{variant:"solid",onClick:()=>h(!0),disabled:t,className:"px-6 py-2 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200",children:t?"Processing...":"Checked"})]})]})})}),Br=()=>{const{id:r}=fe(),s=be(),[n,o]=l.useState(!1),[i,d]=l.useState([]),[t,x]=l.useState(null),[p,u]=l.useState(!1),[h,g]=l.useState(!1),[v,m]=l.useState(""),[b,k]=l.useState(!1),[f,N]=l.useState(!1),[$,ke]=l.useState([]),[w,V]=l.useState(null),[Ce,W]=l.useState(!1),[G,Y]=l.useState(!1),_=(Ve(a=>a.auth.user.authority)||[])[0]||"finance",[Se,Q]=l.useState(!1),Ae=async()=>{W(!0);try{const a=await Pr();ke(a.data.engineers),t!=null&&t.assignedTo&&V(t.assignedTo._id)}catch(a){console.error("Failed to fetch engineers:",a),S.push(e.jsx(A,{title:"Failed to load engineers",type:"danger"}),{placement:"top-center"})}finally{W(!1)}},Ie=()=>{g(!0),Ae()},X=()=>{g(!1)},Te=()=>{t!=null&&t.estimationId&&N(!0)},_e=()=>{N(!1)},Pe=a=>{m(a),k(!0)},Ee=()=>{k(!1)},$e=()=>{R(r).then(a=>{x(a==null?void 0:a.data),Y(c=>!c)}),window.location.reload()},Oe=()=>{R(r).then(a=>{x(a==null?void 0:a.data),Y(c=>!c)})},He=async()=>{var a,c;if(!w||!r){S.push(e.jsx(A,{title:"Please select an engineer",type:"warning"}),{placement:"top-center"});return}Q(!0);try{await Er({projectId:r,engineerId:w}),S.push(e.jsx(A,{title:"Engineer assigned successfully",type:"success"}),{placement:"top-center"});const y=await R(r);x(y==null?void 0:y.data),X()}catch(y){console.error("Assignment failed:",y);let O="Failed to assign engineer";(c=(a=y.response)==null?void 0:a.data)!=null&&c.message&&(O=y.response.data.message),S.push(e.jsx(A,{title:O,type:"danger"}),{placement:"top-center"})}finally{Q(!1)}},Re=a=>{const c=i.find(y=>y.type===a);c&&(a==="expenseTracker"?s(c.exists?c.viewRoute||`/app/expense/${r}`:c.route):s(c.exists&&c.viewRoute||c.route,{state:{projectId:r}}))};return l.useEffect(()=>{u(!0),R(r).then(a=>{var Z,ee,re,se,te,ae,oe,ne,ie,le;x(a==null?void 0:a.data),u(!1);const c=((Z=a==null?void 0:a.data)==null?void 0:Z.status)||"draft",y=(ee=a==null?void 0:a.data)==null?void 0:ee.isApproved,O=!!((re=a==null?void 0:a.data)!=null&&re.assignedTo),J=!!((se=a==null?void 0:a.data)!=null&&se.estimationId),K=!!((te=a==null?void 0:a.data)!=null&&te.quotationId),D=!!((ae=a==null?void 0:a.data)!=null&&ae.lpoId);(oe=a==null?void 0:a.data)!=null&&oe.lopId;const F=!!((ne=a==null?void 0:a.data)!=null&&ne.lpoId),Le=!!((ie=a==null?void 0:a.data)!=null&&ie.expenseId);let C=[...[{type:"estimation",title:"Estimation",route:`/app/create-estimation/${r}`,viewRoute:J?`/app/estimation-view/${a.data.estimationId}`:void 0,exists:J,roles:["finance","super_admin","admin","engineer"]}]];y&&O&&C.push({type:"quotation",title:"Quotation",route:`/app/quotation-new/${r}`,viewRoute:K?`/app/quotation-view/${r}`:void 0,exists:K,roles:["finance","super_admin","admin","engineer"]}),["quotation_sent","lpo_received","work_started","in_progress","work_completed","invoice_sent","team_assigned"].includes(c)&&(_==="engineer"?D&&C.push({type:"lpo",title:"LPO",route:`/app/lpo/${r}`,exists:!0,viewRoute:`/app/lpo-view/${r}`,roles:["finance","super_admin","admin","engineer"]}):C.push({type:"lpo",title:"LPO",route:`/app/lpo/${r}`,exists:D,viewRoute:D?`/app/lpo-view/${r}`:void 0,roles:["finance","super_admin","admin","engineer"]})),["lpo_received","work_started","in_progress","work_completed","invoice_sent","team_assigned"].includes(c)&&C.push({type:"workProgress",title:"Work Progress",route:F?void 0:"/app/workprogress",viewRoute:F?`/app/workprogress/${r}`:void 0,exists:F,roles:["finance","super_admin","admin","engineer"]}),c==="work_completed"&&C.push({type:"workCompletion",title:"Completion Report",viewRoute:`/app/workcompletionreport/${r}`,exists:!0,roles:["finance","super_admin","admin","engineer"]}),c==="work_completed"&&C.push({type:"invoice",title:"Invoice",viewRoute:r?`/app/invoice-view/${r}`:void 0,exists:r,roles:["finance","super_admin","admin"]}),["lpo_received","work_started","in_progress","work_completed","invoice_sent","team_assigned"].includes(c)&&C.push({type:"expenseTracker",title:"Expense Tracker",route:`/app/expense/${r}`,viewRoute:`/app/expense-view/${(le=a==null?void 0:a.data)==null?void 0:le.expenseId}`,exists:Le,roles:["finance","super_admin","admin"]});const Me=C.filter(De=>{var ce;return(ce=De.roles)==null?void 0:ce.includes(_)});d(Me),o(!1)}).catch(a=>{console.error("Error fetching project:",a),u(!1)})},[r,_,G]),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-blue-50 dark:from-gray-900 dark:via-gray-850 dark:to-gray-900",children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg",children:e.jsx(nr,{className:"text-2xl text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Project Documents"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:!n&&i.length>0?i.map(a=>e.jsx(qr,{data:a,onAddClick:Re},a.type)):[...Array(4).keys()].map(a=>e.jsx(E,{className:"h-64",children:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(q,{size:40,color:"#6366f1",loading:n})})},a))})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-750 p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-lg",children:e.jsx(U,{className:"text-2xl text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Project Information"})]})}),e.jsx("div",{className:"p-6",children:e.jsx(_r,{projectdetails:t})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 dark:from-gray-800 dark:to-gray-750 p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-orange-500 to-red-600 rounded-lg",children:e.jsx(me,{className:"text-2xl text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Project Issues"})]})}),e.jsx("div",{className:"p-6",children:e.jsx(Fr,{projectId:r,refresh:G})})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-teal-50 dark:from-gray-800 dark:to-gray-750 p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-green-500 to-teal-600 rounded-lg",children:e.jsx(H,{className:"text-2xl text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Customer Information"})]})}),e.jsx("div",{className:"p-6",children:e.jsx(Tr,{clientinformation:t})})]}),(t==null?void 0:t.estimationId)&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-gray-800 dark:to-gray-750 p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-600 rounded-lg",children:e.jsx(L,{className:"text-2xl text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Project Status"})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-4 rounded-xl border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Status"}),e.jsx(P,{content:(t==null?void 0:t.status)||"draft",className:"px-3 py-1 text-xs font-bold",innerClass:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 p-4 rounded-xl border border-emerald-200 dark:border-emerald-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Verified"}),e.jsx(P,{content:t!=null&&t.isChecked?"Verified":"Pending",className:"px-3 py-1 text-xs font-bold",innerClass:`${t!=null&&t.isChecked?"bg-gradient-to-r from-emerald-500 to-green-600":"bg-gradient-to-r from-amber-500 to-orange-600"} text-white shadow-lg`})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50 dark:from-purple-900/20 dark:to-violet-900/20 p-4 rounded-xl border border-purple-200 dark:border-purple-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Approved"}),e.jsx(P,{content:t!=null&&t.isApproved?"Approved":"Pending",className:"px-3 py-1 text-xs font-bold",innerClass:`${t!=null&&t.isApproved?"bg-gradient-to-r from-emerald-500 to-green-600":"bg-gradient-to-r from-amber-500 to-orange-600"} text-white shadow-lg`})]})})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 dark:from-gray-800/50 dark:to-slate-800/50 p-4 rounded-xl border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Assigned Engineer"}),t!=null&&t.assignedTo?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{size:40,src:t.assignedTo.profileImage,shape:"circle",className:"border-2 border-white shadow-lg"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-gray-800 dark:text-white",children:[t.assignedTo.firstName," ",t.assignedTo.lastName]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Engineer"})]})]}):e.jsx(j,{size:"sm",variant:"solid",icon:e.jsx(H,{}),onClick:Ie,className:"bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white font-semibold px-4 py-2 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200",children:"Assign Engineer"})]})}),e.jsxs("div",{className:"space-y-3",children:[(t==null?void 0:t.assignedTo)&&e.jsx(j,{block:!0,size:"lg",variant:"solid",icon:e.jsx(ve,{}),onClick:()=>s(`/app/attendance-summary/${r}`),className:"bg-gradient-to-r from-blue-500 to-cyan-600 hover:from-blue-600 hover:to-cyan-700 text-white font-semibold py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200",children:"View Attendance Summary"}),["super_admin","admin"].includes(_)&&!(t!=null&&t.isApproved)&&e.jsx(j,{block:!0,size:"lg",variant:"solid",onClick:Te,disabled:!(t!=null&&t.isChecked),icon:t!=null&&t.isChecked?e.jsx(L,{}):e.jsx(me,{}),className:`font-semibold py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 ${t!=null&&t.isChecked?"bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:t!=null&&t.isChecked?"Approve Project":"Verification Required"}),["super_admin","admin","engineer"].includes(_)&&!(t!=null&&t.isChecked)&&e.jsx(j,{block:!0,size:"lg",variant:"solid",onClick:()=>Pe(r||""),icon:e.jsx(Ne,{}),className:"bg-gradient-to-r from-green-500 to-teal-600 hover:from-green-600 hover:to-teal-700 text-white font-semibold py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200",children:"Verify Project"})]})]})]})]})]}),e.jsx(Qe,{title:"Assign Engineer",isOpen:h,onClose:X,width:450,className:"rounded-l-2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg",children:e.jsx(H,{className:"text-2xl text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Select Engineer"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose an engineer to assign to this project"})]})]})}),Ce?e.jsx("div",{className:"flex justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(q,{size:40,color:"#6366f1"}),e.jsx("p",{className:"mt-4 text-gray-500 dark:text-gray-400",children:"Loading engineers..."})]})}):$.length>0?e.jsxs("div",{className:"space-y-4",children:[$.map(a=>{var c;return e.jsxs("div",{className:`group flex items-center justify-between p-4 rounded-xl cursor-pointer transition-all duration-300 border-2 ${w===a._id?"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 border-blue-300 dark:border-blue-600 shadow-lg":"hover:bg-gray-50 dark:hover:bg-gray-700/50 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 hover:shadow-md"}`,onClick:()=>V(a._id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(z,{size:50,src:a.profileImage,className:"border-3 border-white shadow-lg",shape:"circle"}),w===a._id&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(L,{className:"text-xs text-white"})})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-bold text-gray-900 dark:text-white text-lg",children:[a.firstName," ",a.lastName]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:((c=a.phoneNumbers)==null?void 0:c[0])||"No phone number"}),e.jsx("div",{className:"mt-1",children:e.jsx(P,{content:"Engineer",className:"text-xs",innerClass:"bg-gradient-to-r from-green-500 to-teal-600 text-white"})})]})]}),e.jsx("div",{className:`transition-all duration-200 ${w===a._id?"scale-110":"scale-75 opacity-0 group-hover:opacity-50 group-hover:scale-100"}`,children:e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-blue-300 dark:border-blue-600 flex items-center justify-center",children:w===a._id&&e.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full"})})})]},a._id)}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:Se?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{size:20,color:"#6366f1"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Assigning engineer..."})]})}):e.jsx(j,{block:!0,size:"lg",variant:"solid",onClick:He,disabled:!w,className:`font-semibold py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 ${w?"bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:w?"Confirm Assignment":"Select an engineer first"})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-xl",children:[e.jsx(H,{className:"text-4xl text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No engineers available"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Please add engineers to the system first"})]})})]})}),e.jsx(zr,{isOpen:f,onClose:_e,estimationId:t==null?void 0:t.estimationId,onSuccess:$e}),e.jsx(Ur,{isOpen:b,onClose:Ee,estimationId:(t==null?void 0:t.estimationId)||"",onSuccess:Oe})]})})};Ye("cryptoWallets",wr);const Ms=()=>e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(Br,{})});export{Ms as default};
