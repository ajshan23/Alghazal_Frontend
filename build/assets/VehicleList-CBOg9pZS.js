import{r as l,j as e,v as w}from"./index-cbxZr22l.js";import{A as E}from"./AdaptableCard-CZjN_iCO.js";import{D as I}from"./DataTable-C4s3mb93.js";import{W as M,$ as z,V as B,_ as L}from"./index-DGePi-hy.js";import{i as O}from"./index-DdVDk-x0.js";import{u as P}from"./useQuery-xrcIc1U-.js";import{d as R}from"./debounce-D8MaWg1g.js";import{I as F}from"./Input-CoANB9Wy.js";import{d as H,f as q}from"./api-BId_EcBn.js";import{C as _}from"./ConfirmDialog-DHHutcW4.js";import{t as k,N}from"./toast-BCRt4NsN.js";import"./Alert-CSp5bS7v.js";import"./index-5KOQOspk.js";import"./Badge-DfD0Ukso.js";import{B as g}from"./Button-FHJPdulA.js";import"./index-CpMcTudo.js";import"./Card-RZl4E4-O.js";import"./index-CX5Y9eeL.js";import"./Dialog-OmmgehMy.js";import"./Drawer-Dn9ylrlH.js";import"./index-BM7LESIb.js";import"./FormItem-Dsb0hqaN.js";import"./useUniqueId-uw_CuIVG.js";import"./Upload-DyKyTg7Q.js";import"./index-BLEb6Y8m.js";import"./index-B6FuZSSV.js";import"./ScrollBar-B_8Ws9P0.js";import"./Select-DnpJ3Vfh.js";import"./Tag-DRJajbyJ.js";import"./Views-B4cM7RDw.js";import"./toString-DDHIFlh6.js";import"./context-Ci1lPV1_.js";import"./StatusIcon-CfTAV1XC.js";import"./CloseButton-BgX1UjTO.js";import"./chainedFunction-BxZSneMW.js";import"./proxy-CCW0hh_w.js";import"./floating-ui.react-CXyQfini.js";import"./floating-ui.dom-B_iSk-nO.js";import"./index-pMPtRiQM.js";import"./_getPrototype-DErBkxwa.js";import"./index-BUmdAIPo.js";import"./index-C8fXiORa.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-85N_kEkV.js";const Q=({isOpen:r,onClose:s,vehicle:a,refetch:p})=>{const[o,n]=l.useState(!1);if(!r||!a)return null;const h=async()=>{var c,m;n(!0);try{await H(a._id),p(),k.push(e.jsx(N,{title:`Vehicle "${a.vehicleNumber}" deleted`,type:"success",duration:2500,children:`${a.make} ${a.model} (${a.vehicleNumber}) has been successfully deleted.`}),{placement:"top-center"}),s()}catch(i){console.error("Delete failed:",i),k.push(e.jsx(N,{title:`Failed to delete vehicle "${a.vehicleNumber}"`,type:"danger",duration:2500,children:((m=(c=i==null?void 0:i.response)==null?void 0:c.data)==null?void 0:m.message)||i.message||"Something went wrong"}),{placement:"top-center"})}finally{n(!1)}};return e.jsxs(_,{isOpen:r,type:"danger",title:`Delete Vehicle "${a.vehicleNumber}"`,confirmButtonColor:"red-600",onClose:s,onRequestClose:s,onCancel:s,onConfirm:h,confirmButtonDisabled:o,children:[e.jsxs("p",{children:['Are you sure you want to delete the vehicle "',a.make," ",a.model,'" with registration number'," ",a.vehicleNumber,"? This action cannot be undone."]}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"All associated records will also be removed."}),o&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("div",{className:"w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})})]})},W=({row:r,onDeleteClick:s})=>{const a=w();return e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(g,{size:"sm",variant:"plain",icon:e.jsx(B,{}),onClick:()=>a(`/app/new-vehicle/${r._id}`),className:"text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",tooltip:"Edit Vehicle"}),e.jsx(g,{size:"sm",variant:"plain",icon:e.jsx(L,{}),onClick:()=>s(r),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors",tooltip:"Delete Vehicle"})]})},G=({row:r})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-lg mr-3",children:e.jsx(O,{className:"text-white text-lg"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800 dark:text-white",children:r.vehicleNumber}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.make," ",r.model," (",r.year,")"]})]})]}),J=({status:r})=>{const s={active:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-300",border:"border-emerald-200 dark:border-emerald-800",label:"Active"},inactive:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300",border:"border-amber-200 dark:border-amber-800",label:"Inactive"},maintenance:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-300",border:"border-red-200 dark:border-red-800",label:"Maintenance"}},a=s[r]||s.inactive;return e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${a.bg} ${a.text} border ${a.border} capitalize`,children:a.label})},U=({color:r})=>r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border border-gray-300 dark:border-gray-600",style:{backgroundColor:r.toLowerCase()}}),e.jsx("span",{className:"capitalize text-gray-700 dark:text-gray-300",children:r})]}):e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"N/A"}),b=({date:r})=>r?e.jsx("span",{className:"text-gray-600 dark:text-gray-400 text-sm font-medium",children:new Date(r).toLocaleDateString()}):e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"N/A"}),X=({mileage:r})=>e.jsxs("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:[r.toLocaleString()," km"]}),Y=()=>{var j,v;const r=l.useRef(null),s=w(),[a,p]=l.useState(""),[o,n]=l.useState({page:1,limit:10}),[h,c]=l.useState(null),[m,i]=l.useState(!1),{data:d,isLoading:C,error:f,refetch:y}=P({queryKey:["vehicles",o.page,o.limit,a],queryFn:()=>q({page:o.page,limit:o.limit,search:a})}),D=((j=d==null?void 0:d.data)==null?void 0:j.vehicles)||[],u=((v=d==null?void 0:d.data)==null?void 0:v.pagination)||{total:0,page:1,limit:10},S=l.useMemo(()=>R(t=>{p(t),n(x=>({...x,page:1}))},500),[]),V=t=>{S(t.target.value)},A=t=>{c(t),i(!0)},$=l.useMemo(()=>[{header:"Vehicle",accessorKey:"vehicleNumber",cell:t=>e.jsx(G,{row:t.row.original})},{header:"Type",accessorKey:"vehicleType",cell:t=>e.jsx("span",{className:"capitalize text-gray-700 dark:text-gray-300",children:t.row.original.vehicleType})},{header:"Color",accessorKey:"color",cell:t=>e.jsx(U,{color:t.row.original.color})},{header:"Registration",accessorKey:"registrationDate",cell:t=>e.jsx(b,{date:t.row.original.registrationDate})},{header:"Insurance Expiry",accessorKey:"insuranceExpiry",cell:t=>e.jsx(b,{date:t.row.original.insuranceExpiry})},{header:"Last Service",accessorKey:"lastServiceDate",cell:t=>e.jsx(b,{date:t.row.original.lastServiceDate})},{header:"Mileage",accessorKey:"currentMileage",cell:t=>e.jsx(X,{mileage:t.row.original.currentMileage})},{header:"Status",accessorKey:"status",cell:t=>e.jsx(J,{status:t.row.original.status})},{header:"Actions",id:"action",cell:t=>e.jsx(W,{row:t.row.original,onDeleteClick:A}),enableSorting:!1}],[]),T=t=>{n(x=>({...x,page:t}))},K=t=>{n(x=>({page:1,limit:t}))};return f?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 text-center",children:[e.jsx("div",{className:"text-red-600 dark:text-red-400 font-medium mb-2",children:"Error loading vehicles"}),e.jsx("div",{className:"text-sm text-red-500 dark:text-red-300",children:f.message}),e.jsx(g,{className:"mt-4",onClick:()=>y(),variant:"solid",children:"Try Again"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Vehicles"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(F,{placeholder:"Search vehicles...",onChange:V,className:"max-w-md",prefix:e.jsx(M,{className:"text-lg text-gray-400"})}),e.jsx(g,{variant:"solid",icon:e.jsx(z,{}),className:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white",onClick:()=>s("/app/new-vehicle"),children:"Add Vehicle"})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsx(I,{ref:r,columns:$,data:D,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:C,pagingData:{total:u.total,pageIndex:u.page,pageSize:u.limit},onPaginationChange:T,onSelectChange:K})}),e.jsx(Q,{isOpen:m,onClose:()=>i(!1),vehicle:h,refetch:y})]})},qe=()=>e.jsx(E,{className:"h-full",bodyClass:"h-full",children:e.jsx(Y,{})});export{qe as default};
